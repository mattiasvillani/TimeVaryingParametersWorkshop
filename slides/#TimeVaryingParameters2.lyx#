#LyX 2.4 created this file. For more info see https://www.lyx.org/
\lyxformat 620
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass beamer
\begin_preamble


% you can play with different themes and color themes to find your favorite combination.
\mode<presentation> {
  \usetheme{Luebeck}
  \usecolortheme{beaver}
  \beamertemplatenavigationsymbolsempty
 
}

\usepackage{mathtools}
\usepackage{graphicx} % for including images
\usepackage{pgf} % for logo
\usepackage{colortbl}
\usepackage{booktabs}
\usepackage{listings}
\usepackage[many]{tcolorbox}
\usepackage{tabularx}
\usepackage{array}
\tcbuselibrary{skins}
%\usepackage{fdsymbol} % for card symbols


\newcolumntype{Y}{>{\raggedleft\arraybackslash}X}
\tcbset{tab2/.style={enhanced, fontupper=\small,
colback=lightgray!10!white,colframe=cobalt!50!black,colbacktitle=lightsteelblue!40!white,
coltitle=black,center title}}

\newcommand\boldblue[1]{\textcolor{cobalt}{\textbf{#1}}}
\newcommand\boldorange[1]{\textcolor{burntoranger}{\textbf{#1}}}
\def\*#1{\mathbf{#1}}

\date{} % Date, can be changed to a custom date

\titlegraphic{
\vspace{-0.6cm}
\includegraphics[width=1.5cm]{/misc/LogoBlueJustRing.jpg}\break


\tiny
\vspace{1cm}
\href{https://mattiasvillani.com}{\includegraphics[width=0.33cm]{/misc/web.png} mattiasvillani.com}\hspace*{1cm}~
\href{https://bsky.app/profile/matvil.bsky.social}{\includegraphics[width=0.3cm]{/misc/bluesky.png} @matvil}\hspace*{1cm}~
\href{https://fosstodon.org/@matvil}{\includegraphics[width=0.3cm]{/misc/mastodon.pdf} @matvil}\hspace*{1cm}~
\href{https://github.com/mattiasvillani}{\includegraphics[width=0.3cm]{/misc/github.png} mattiasvillani}~
}


\definecolor{blue}{RGB}{38, 122, 181}
\definecolor{orange}{RGB}{255, 128, 0}
\definecolor{lorange}{RGB}{255, 178, 102}
\definecolor{llorange}{RGB}{255, 229,204 }
\definecolor{verylightgray}{RGB}{246, 246, 246}
\definecolor{cobalt}{HTML}{0047AB}
\definecolor{lightsteelblue}{HTML}{b0c4de}

\definecolor{shadecolor}{rgb}{236, 236, 236}

\setbeamertemplate{itemize item}{\color{orange}$\blacksquare$}
\setbeamertemplate{itemize subitem}{\color{orange}$\blacktriangleright$}
\usepackage{tcolorbox}



\newcommand\blfootnote[1]{%
  \begingroup
  \renewcommanemod\thefootnote{}\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \endgroup
}

\setbeamertemplate{footline}{}
\end_preamble
\options xcolor=svgnames
\use_default_options false
\maintain_unincluded_children no
\language english
\language_package default
\inputencoding auto-legacy
\fontencoding auto
\font_roman "palatino" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts true
\font_sc false
\font_roman_osf false
\font_sans_osf false
\font_typewriter_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\float_placement class
\float_alignment class
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 0
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_formatted_ref 0
\use_minted 0
\use_lineno 0
\boxbgcolor #bfbc40
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tablestyle default
\tracking_changes false
\output_changes false
\change_bars false
\postpone_fragile_content false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\docbook_table_output 0
\docbook_mathml_prefix 1
\end_header

\begin_body

\begin_layout Title

\size largest
\color orange
Inference in linear Gaussian models 
\size default

\begin_inset Argument 1
status open

\begin_layout Plain Layout

\color gray
UTS 2026
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hspace{2.7cm}
\backslash
insertframenumber/
\backslash
inserttotalframenumber
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Author
Mattias Villani
\begin_inset Argument 1
status open

\begin_layout Plain Layout

\series bold
\color gray
Mattias Villani
\end_layout

\end_inset


\end_layout

\begin_layout Institute

\series bold
Department of Statistics
\begin_inset Newline newline
\end_inset

Stockholm University
\series default

\begin_inset Argument 1
status open

\begin_layout Plain Layout
Stockholm University
\end_layout

\end_inset


\end_layout

\begin_layout Date
\begin_inset space \thinspace{}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout

\series bold
\color orange
Inference about the state
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
\color blue
Filtering posterior
\series default
\color inherit
:
 
\begin_inset Formula $p(\boldsymbol{z}_{t}\vert y_{1:t})$
\end_inset

.
 Instantaneous posterior.
\series bold
\color blue

\begin_inset VSpace bigskip
\end_inset


\end_layout

\begin_layout Itemize

\series bold
\color blue
Smoothing posterior
\series default
\color inherit
:
 
\begin_inset Formula $p(\boldsymbol{z}_{t}\vert y_{1:T})$
\end_inset

.
 Retrospective posterior.
\series bold
\color blue

\begin_inset VSpace bigskip
\end_inset


\end_layout

\begin_layout Itemize

\series bold
\color blue
Joint smoothing posterior
\series default
\color inherit
:
 
\begin_inset Formula $p(\boldsymbol{z}_{1:T}\vert y_{1:T})$
\end_inset

.
 
\series bold
\color blue

\begin_inset VSpace bigskip
\end_inset


\begin_inset VSpace bigskip
\end_inset


\end_layout

\begin_layout Itemize
Prior on initial state:
 
\begin_inset Formula $p(\boldsymbol{z}_{0})$
\end_inset

.
 Often 
\begin_inset Formula $\boldsymbol{z}_{0}\sim N(\boldsymbol{\mu}_{0\vert0},\boldsymbol{\Omega}_{0\vert0})$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout

\series bold
\color orange
The Bayes filter
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset Graphics
	filename /home/mv/Dropbox/BayesBook/Figs/BayesFilterDimmedOut.pdf
	lyxscale 30
	scale 45

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout

\series bold
\color orange
The Bayes filter
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset Graphics
	filename figs/BayesFilter.png
	lyxscale 30
	scale 18

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout

\series bold
\color orange
The Kalman filter
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Linear Gaussian models 
\begin_inset Formula $\Rightarrow$
\end_inset

 Bayes filter in closed form.
\begin_inset VSpace bigskip
\end_inset


\end_layout

\begin_layout Itemize
Priors and posteriors are Gaussian.
 Mean/variance over time.
\begin_inset VSpace bigskip
\end_inset


\end_layout

\begin_layout Itemize

\series bold
\color blue
Prior at time 
\begin_inset Formula $t$
\end_inset


\series default
\color inherit

\begin_inset Formula 
\[
\boldsymbol{z}_{0}\sim N(\boldsymbol{\mu}_{0\vert0},\boldsymbol{\Omega}_{0\vert0})
\]

\end_inset


\end_layout

\begin_layout Itemize

\series bold
\color blue
Prior at time 
\begin_inset Formula $t$
\end_inset


\series default
\color inherit

\begin_inset Formula 
\[
\boldsymbol{z}_{t}\vert\boldsymbol{y}_{1:t-1}\sim N(\boldsymbol{\mu}_{t\vert t-1},\boldsymbol{\Omega}_{t\vert t-1})
\]

\end_inset


\end_layout

\begin_layout Itemize

\series bold
\color blue
Posterior at time 
\begin_inset Formula $t$
\end_inset


\series default
\color inherit

\begin_inset Formula 
\[
\boldsymbol{z}_{t}\vert\boldsymbol{y}_{1:t}\sim N(\boldsymbol{\mu}_{t\vert t},\boldsymbol{\Omega}_{t\vert t})
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout

\series bold
\color orange
The Kalman filter algorithm
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset Graphics
	filename figs/KalmanFilter.png
	lyxscale 30
	scale 15

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout

\series bold
\color orange
Interactive:
 Kalman filtering local level data
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "1pt"
separation "1pt"
shadowsize "4pt"
framecolor "orange"
backgroundcolor "white"
status open

\begin_layout Plain Layout
\align center
\begin_inset CommandInset href
LatexCommand href
name "\\includegraphics[width=0.5\\textwidth]{./figs/KalmanLocalLevelData.png}"
target "https://observablehq.com/@mattiasvillani/kalman-filter-simulated-local-level"
literal "true"

\end_inset


\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout

\series bold
\color orange
Interactive:
 Kalman filtering Nile river data
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "1pt"
separation "1pt"
shadowsize "4pt"
framecolor "orange"
backgroundcolor "white"
status open

\begin_layout Plain Layout
\align center
\begin_inset CommandInset href
LatexCommand href
name "\\includegraphics[width=0.7\\textwidth]{./figs/KalmanFilterNile.png}"
target "https://observablehq.com/@mattiasvillani/kalman-filtering-nile-river-data"
literal "true"

\end_inset


\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout

\series bold
\color orange
The Kalman filter time update in Julia
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset Graphics
	filename figs/KalmanFilterAlgorithmJulia.png
	lyxscale 30
	scale 35

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout

\series bold
\color orange
The Kalman filter algorithm in Julia
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset Graphics
	filename figs/KalmanFilterAlgorithmJulia.png
	lyxscale 30
	scale 35

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout

\series bold
\color orange
R demo using the dlm package
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
install.packages("dlm") 
\emph on
# uncomment the first time to install.
\end_layout

\begin_layout Itemize
library(dlm)
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout

\series bold
\color orange
Sampling from the joint smoothing posterior
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
\color blue
Joint smoothing posterior
\series default
\color inherit
 decomposed backward in time:
\begin_inset Formula 
\begin{align*}
p(\boldsymbol{z}_{1:T}\vert\boldsymbol{y}_{1:T}) & =p(\boldsymbol{z}_{T}\vert\boldsymbol{y}_{1:T})p(\boldsymbol{z}_{T-1}\vert\boldsymbol{z}_{T},\boldsymbol{y}_{1:T})\cdots p(\boldsymbol{z}_{0}\vert\boldsymbol{z}_{1:T},\boldsymbol{y}_{1:T})\\
 & =p(\boldsymbol{z}_{T}\vert\boldsymbol{y}_{1:T})\prod_{t=1}^{T-1}p(\boldsymbol{z}_{t}\vert\boldsymbol{z}_{t+1:T},\boldsymbol{y}_{1:T})
\end{align*}

\end_inset


\end_layout

\begin_layout Itemize
The assumptions of the state-space model imply that
\begin_inset Formula 
\[
p(\boldsymbol{z}_{t}\vert\boldsymbol{z}_{t+1:T},\boldsymbol{y}_{1:T})=p(\boldsymbol{z}_{t}\vert\boldsymbol{z}_{t+1},\boldsymbol{y}_{1:t})
\]

\end_inset


\end_layout

\begin_layout Itemize

\series bold
\color blue
Kalman smoother
\series default
\color inherit
:
 recursion to compute marginal posteriors for linear Gaussian models.
\end_layout

\begin_layout Itemize
Compute smoothed estimates backward in time
\begin_inset Formula 
\[
\boldsymbol{\mu}_{t\vert T},\boldsymbol{\Omega}_{t\vert T}\quad\text{ for }t=T,T-1,\ldots,1
\]

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

Initial
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula $\boldsymbol{\mu}_{T\vert T}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{\Omega}_{T\vert T}$
\end_inset

 available from the Kalman filter.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout

\series bold
\color orange
Forward Filtering Backward Sampling (FFBS)
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Sampling from the joint smoothing posterior 
\begin_inset Formula $p(\boldsymbol{z}_{1:T}\vert\boldsymbol{y}_{1:T})$
\end_inset

.
\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename figs/FFBS.png
	lyxscale 30
	scale 18
	BoundingBox 0bp 10bp 1405bp 1226bp
	clip

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout

\series bold
\color orange
Inference about static parameters
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Joint posterior of the state 
\begin_inset Formula $\boldsymbol{z}_{1:T}$
\end_inset

 and parameters 
\begin_inset Formula $\boldsymbol{\theta}$
\end_inset


\begin_inset Formula 
\[
p(\boldsymbol{\theta},\boldsymbol{z}_{1:T}\vert\boldsymbol{y}_{1:T})
\]

\end_inset


\end_layout

\begin_layout Itemize
Example:
 Local level model with static parameters 
\begin_inset Formula $\boldsymbol{\theta}=(\sigma_{\varepsilon}^{2},\sigma_{\eta}^{2})$
\end_inset

.
\begin_inset VSpace bigskip
\end_inset


\end_layout

\begin_layout Itemize

\series bold
\color blue
Gibbs sampling
\series default
\color inherit
:
\begin_inset Formula 
\begin{align*}
\text{Sample: }\boldsymbol{\theta}\vert\boldsymbol{z}_{1:T},\boldsymbol{y}_{1:T}\\
\text{Sample: }\boldsymbol{z}_{1:T}\vert\boldsymbol{\theta},\boldsymbol{y}_{1:T}
\end{align*}

\end_inset


\end_layout

\begin_layout Itemize

\series bold
\color blue
Marginal-conditional sampling
\series default
\color inherit
:
\begin_inset Formula 
\begin{align*}
\text{Sample:\hspace*{0.85cm} }\boldsymbol{\theta}\vert\boldsymbol{y}_{1:T}\\
\text{Sample: }\boldsymbol{z}_{1:T}\vert\boldsymbol{\theta},\boldsymbol{y}_{1:T}
\end{align*}

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout

\series bold
\color orange
The Kalman filter marginalizes out the state
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Marginal posterior:
 
\begin_inset Formula 
\[
p(\boldsymbol{\theta}\vert\boldsymbol{y}_{1:T})\propto p(\boldsymbol{y}_{1:T}\vert\boldsymbol{\theta})p(\boldsymbol{\theta})
\]

\end_inset


\end_layout

\begin_layout Itemize
The 
\series bold
\color blue
marginal likelihood
\series default
\color inherit
 
\begin_inset Formula $p(\boldsymbol{y}_{1:T}\vert\boldsymbol{\theta})$
\end_inset


\begin_inset Formula 
\[
p(\boldsymbol{y}_{1:T}\vert\boldsymbol{\theta})=\prod_{t=1}^{T}p(\boldsymbol{y}_{t}\vert\boldsymbol{y}_{1:t-1},\boldsymbol{\theta})
\]

\end_inset

where 
\begin_inset Formula 
\[
p(\boldsymbol{y}_{t}\vert\boldsymbol{y}_{1:t-1},\boldsymbol{\theta})=\int p(\boldsymbol{y}_{t}\vert\textcolor{orange}{\boldsymbol{z}_{t}},\boldsymbol{\theta})p(\textcolor{orange}{\boldsymbol{z}_{t}}\vert\boldsymbol{y}_{1:t-1},\boldsymbol{\theta})d\textcolor{orange}{\boldsymbol{z}_{t}}
\]

\end_inset


\end_layout

\begin_layout Itemize
Linear Gaussian models:
 integrals are tractable and
\begin_inset Formula 
\[
p(\boldsymbol{y}_{t}\vert\boldsymbol{y}_{1:t-1},\boldsymbol{\theta})=N(\boldsymbol{y}_{t}\vert\boldsymbol{C}\boldsymbol{\mu}_{t\vert t-1},\,\boldsymbol{C}\boldsymbol{\Omega}_{t\vert t-1}\boldsymbol{C}^{\top}+\boldsymbol{\Sigma}_{\varepsilon})
\]

\end_inset


\end_layout

\begin_layout Itemize

\series bold
\color blue
Maximum likelihood estimator
\series default
\color inherit

\begin_inset Formula 
\[
\hat{\boldsymbol{\theta}}=\underset{\boldsymbol{\theta}\in\boldsymbol{\Theta}}{\arg\max}p(\boldsymbol{y}_{1:T}\vert\boldsymbol{\theta})
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout

\series bold
\color orange
Marginal likelihood
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset Graphics
	filename figs/MarginalLikelihoodKalman.png
	lyxscale 30
	scale 18
	BoundingBox 0bp 10bp 1405bp 1226bp
	clip

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout

\series bold
\color orange
Interactive:
 Kalman filtering Nile river data
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "1pt"
separation "1pt"
shadowsize "4pt"
framecolor "orange"
backgroundcolor "white"
status open

\begin_layout Plain Layout
\align center
\begin_inset CommandInset href
LatexCommand href
name "\\includegraphics[width=0.7\\textwidth]{./figs/KalmanFilterNile.png}"
target "https://observablehq.com/@mattiasvillani/kalman-filtering-nile-river-data"
literal "true"

\end_inset


\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\end_body
\end_document
